diff --git a/CMakeLists.txt b/CMakeLists.txt
index 18f8460..065838c 100644
--- a/CMakeLists.txt
+++ b/CMakeLists.txt
@@ -351,12 +351,12 @@ if (Threads_FOUND)
 endif ()
 
 if (OPENMP_FOUND)
-  add_library (${fftw3_lib}_omp ${fftw_omp_SOURCE})
+  add_library (${fftw3_lib}_omp ${SOURCEFILES} ${fftw_omp_SOURCE})
   target_include_directories (${fftw3_lib}_omp INTERFACE $<INSTALL_INTERFACE:include>)
   target_link_libraries (${fftw3_lib}_omp ${fftw3_lib})
   target_link_libraries (${fftw3_lib}_omp ${CMAKE_THREAD_LIBS_INIT})
   list (APPEND subtargets ${fftw3_lib}_omp)
-  target_compile_options (${fftw3_lib}_omp PRIVATE ${OpenMP_C_FLAGS})
+  target_link_libraries (${fftw3_lib}_omp OpenMP::OpenMP_C)
 endif ()
 
 foreach(subtarget ${subtargets})
